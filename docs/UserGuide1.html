<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="themes/apigen/theme-phpcap/src/resources/style.css">
<link rel="stylesheet" href="themes/apigen/theme-phpcap/src/resources/docstyle.css">
<title>PHPCap Documentation</title>
</head>
<body>
<div id="left">
<div id="menu">
<div id="topmenu">
<span>PHPCap Docs</span> | <a href="api/index.html">PHPCap API</a>
<hr />
</div>
<a href="index.html" title="Overview"><span id="overview">Overview</span></a>
<ul>
<li><a href="CACertificateFile.html">CA Certificate File Info</a></li>
<li><a href="DeveloperGuide.html">Developer Guide</a></li>
<li class="active"><a href="UserGuide1.html">User Guide 1 - Getting Started</a></li>
<li><a href="UserGuide2.html">User Guide 2 - API Overview</a></li>
<li><a href="UserGuide3.html">User Guide 3 - Exporting Records</a></li>
<li><a href="UserGuide4.html">User Guide 4 - Extending PHPCap</a></li>
</ul>
</div>
</div>
<div id="splitter"></div>
<div id="right">
<div id="rightInner">
<div id="content">
<h1>User Guide 1 - Getting Started</h1>
<h2>Prerequisites</h2>
<ul>
<li><strong>Your REDCap API URL.</strong> You need to know the URL of your REDCap's API (Application programming interface)</li>
<li><strong>REDCap Project with API Token.</strong> You need to have an API token for a project in REDCap. You would typically get this
by creating a project in REDCap and then requesting an API token.</li>
<li><strong>PHP 5.6+ with cURL and OpenSSL.</strong>You need to have a computer (with Internet access) that has PHP version 5.6 or greater installed. And you need to have the following PHP modules enabled:
<ul>
<li>cURL</li>
<li>OpenSSL</li>
</ul></li>
</ul>
<p>Example PHP Setup on Ubuntu 16:</p>
<div class="description"><pre><code>sudo apt-get install php php-curl</code></pre></div>
<p>Information on installing PHP on Windows: <a href="http://php.net/manual/en/install.windows.php">http://php.net/manual/en/install.windows.php</a></p>
<h2>Creating a PHPCap Project</h2>
<h3>Create a project directory.</h3>
<p>Create a directory for your project, and cd to that directory:</p>
<div class="description"><pre><code>mkdir phpcap-project
cd phpcap-project</code></pre></div>
<h3>Get PHPCap</h3>
<p>Get PHPCap from GitHub. If you have Git installed, you can use the following:</p>
<div class="description"><pre><code>git clone https://github.com/aarenson/PHPCap </code></pre></div>
<p>If you don't have Git installed, you can get a Zip file of PHPCap by clicking on this link:</p>
<p><a href="https://github.com/aarenson/PHPCap/archive/master.zip">https://github.com/aarenson/PHPCap/archive/master.zip</a></p>
<p>Or go to this page and click on the &quot;Clone of download&quot; button, and then click on &quot;Download ZIP&quot;:</p>
<p><a href="https://github.com/aarenson/PHPCap/">https://github.com/aarenson/PHPCap/</a></p>
<p>Then unzip the file to your project directory.</p>
<p>You should now have the following directory structure:</p>
<div class="description"><pre><code>phpcap-project/
    PHPCap/
        docs/
        src/
        ...</code></pre></div>
<h3>Create your first test program.</h3>
<p>Create a file <strong>test.php</strong> in your project directory:</p>
<div class="description"><pre><code>phpcap-project/
    PHPCap/
        docs/
        src/
        ...
        autoloader.php
        ...
    test.php</code></pre></div>
<p>Enter the following into the <strong>test.php</strong> file, modifying the API URL and token to match those for your REDCap project:</p>
<div class="description"><pre><code class="language-php"><span class="xlang">&lt;?php</span>

<span class="php-keyword1">require</span>(<span class="php-quote">'PHPCap/autoloader.php'</span>);

<span class="php-keyword1">use</span> IU\PHPCap\RedCapProject;

<span class="php-var">$apiUrl</span> = <span class="php-quote">'https://redcap.xxxxx.edu/api/'</span>;  <span class="php-comment"># replace this URL with your institution's</span>
                                            <span class="php-comment"># REDCap API URL.</span>

<span class="php-var">$apiToken</span> = <span class="php-quote">'1234567890A1234567890B1234567890'</span>;    <span class="php-comment"># replace with your actual API token</span>

<span class="php-var">$project</span> = <span class="php-keyword1">new</span> RedCapProject(<span class="php-var">$apiUrl</span>, <span class="php-var">$apiToken</span>);
<span class="php-var">$projectInfo</span> = <span class="php-var">$project</span>-&gt;exportProjectInfo();

<span class="php-keyword2">print_r</span>(<span class="php-var">$projectInfo</span>);</code></pre></div>
<p>Run the test program using the following command in your project directory:</p>
<div class="description"><pre><code>php test.php</code></pre></div>
<p>You should see output generated with information about your project.
It should look similar to the following, although some of the values will
probably be different:</p>
<div class="description"><pre><code class="language-php"><span class="php-keyword1">Array</span>
(
    [project_id] =&gt; <span class="php-num">9639</span>
    [project_title] =&gt; PHPCap Basic Demography Test
    [creation_time] =&gt; <span class="php-num">2017</span>-<span class="php-num">03</span>-<span class="php-num">31</span> <span class="php-num">13</span>:<span class="php-num">40</span>:<span class="php-num">53</span>
    [production_time] =&gt; 
    [in_production] =&gt; <span class="php-num">0</span>
    [project_language] =&gt; English
    [purpose] =&gt; <span class="php-num">1</span>
    [purpose_other] =&gt; PHPCap testing
    [project_notes] =&gt; 
    [custom_record_label] =&gt; 
    [secondary_unique_field] =&gt; 
    [is_longitudinal] =&gt; <span class="php-num">0</span>
    [surveys_enabled] =&gt; <span class="php-num">1</span>
    [scheduling_enabled] =&gt; <span class="php-num">0</span>
    [record_autonumbering_enabled] =&gt; <span class="php-num">0</span>
    [randomization_enabled] =&gt; <span class="php-num">0</span>
    [ddp_enabled] =&gt; <span class="php-num">0</span>
    [project_irb_number] =&gt; 
    [project_grant_number] =&gt; 
    [project_pi_firstname] =&gt; 
    [project_pi_lastname] =&gt; 
    [display_today_now_button] =&gt; <span class="php-num">1</span>
)</code></pre></div>
<h3>Making your test program secure.</h3>
<p>The program above is not secure, because it does not use SSL verification to verify that the
REDCap site accessed is the one actually intended. To make the program more secure, it
should use SSL verification. </p>
<p>To do this you need to add the SSL verify flag and set it to true:</p>
<div class="description"><pre><code class="language-php">...
<span class="php-var">$sslVerify</span> = <span class="php-keyword1">true</span>;
<span class="php-var">$project</span> = <span class="php-keyword1">new</span> RedCapProject(<span class="php-var">$apiUrl</span>, <span class="php-var">$apiToken</span>, <span class="php-var">$sslVerify</span>);
...</code></pre></div>
<p>But unless your system has already been set up to verify connections, you will need to create a
certificate file
for this, and add it also. Information on creating the file
can be found here: <a href="CACertificateFile.html">CA Certificate file</a></p>
<p>Assuming the file was created with the name 'USERTrustRSACertificationAuthority.crt' and is in
you top-level project directory, the project creation would now be modified to the following:</p>
<div class="description"><pre><code class="language-php">...
<span class="php-var">$sslVerify</span> = <span class="php-keyword1">true</span>;
<span class="php-var">$caCertificateFile</span> = <span class="php-quote">'USERTrustRSACertificationAuthority.crt'</span>;
<span class="php-var">$project</span> = <span class="php-keyword1">new</span> RedCapProject(<span class="php-var">$apiUrl</span>, <span class="php-var">$apiToken</span>, <span class="php-var">$sslVerify</span>, <span class="php-var">$caCertificateFile</span>);
...</code></pre></div>
<p>So, at this point, your project directory should look as follows:</p>
<div class="description"><pre><code>phpcap-project/
    PHPCap/
        docs/
        src/
        ...
        autoloader.php
        ...
    test.php
    USERTrustRSACertificationAuthority.crt</code></pre></div>
<p>And your test program should look similar to the following:</p>
<div class="description"><pre><code class="language-php"><span class="xlang">&lt;?php</span>

<span class="php-keyword1">require</span>(<span class="php-quote">'PHPCap/autoloader.php'</span>);

<span class="php-keyword1">use</span> IU\PHPCap\RedCapProject;

<span class="php-var">$apiUrl</span> = <span class="php-quote">'https://redcap.xxxxx.edu/api/'</span>;  <span class="php-comment"># replace this URL with your institution's</span>
                                            <span class="php-comment"># REDCap API URL.</span>

<span class="php-var">$apiToken</span> = <span class="php-quote">'1234567890A1234567890B1234567890'</span>;    <span class="php-comment"># replace with your actual API token</span>

<span class="php-var">$sslVerify</span> = <span class="php-keyword1">true</span>;
<span class="php-var">$caCertificateFile</span> = <span class="php-quote">'USERTrustRSACertificationAuthority.crt'</span>;
<span class="php-var">$project</span> = <span class="php-keyword1">new</span> RedCapProject(<span class="php-var">$apiUrl</span>, <span class="php-var">$apiToken</span>, <span class="php-var">$sslVerify</span>, <span class="php-var">$caCertificateFile</span>);
<span class="php-var">$projectInfo</span> = <span class="php-var">$project</span>-&gt;exportProjectInfo();

<span class="php-keyword2">print_r</span>(<span class="php-var">$projectInfo</span>);</code></pre></div>
<p>If everything is working correctly, the test program should (still) output information about your project.</p>
<h3>Checking for errors.</h3>
<p>In general, when an error occurs in PHPCap, it throws a PhpCapException.
These exceptions can be checked and handled using &quot;try&quot; and &quot;catch&quot;. For example,
to handle exceptions in the sample program, it could be modified as follows:</p>
<div class="description"><pre><code class="language-php"><span class="xlang">&lt;?php</span>

<span class="php-keyword1">require</span>(<span class="php-quote">'PHPCap/autoloader.php'</span>);

<span class="php-keyword1">use</span> IU\PHPCap\RedCapProject;
<span class="php-keyword1">use</span> IU\PHPCap\PhpCapException;

<span class="php-var">$apiUrl</span> = <span class="php-quote">'https://redcap.xxxxx.edu/api/'</span>;  <span class="php-comment"># replace this URL with your institution's</span>
                                            <span class="php-comment"># REDCap API URL.</span>

<span class="php-var">$apiToken</span> = <span class="php-quote">'1234567890A1234567890B1234567890'</span>;    <span class="php-comment"># replace with your actual API token</span>

<span class="php-var">$sslVerify</span> = <span class="php-keyword1">true</span>;
<span class="php-var">$caCertificateFile</span> = <span class="php-quote">'USERTrustRSACertificationAuthority.crt'</span>;
<span class="php-keyword1">try</span> {
    <span class="php-var">$project</span> = <span class="php-keyword1">new</span> RedCapProject(<span class="php-var">$apiUrl</span>, <span class="php-var">$apiToken</span>, <span class="php-var">$sslVerify</span>, <span class="php-var">$caCertificateFile</span>);
    <span class="php-var">$projectInfo</span> = <span class="php-var">$project</span>-&gt;exportProjectInfo();
    <span class="php-keyword2">print_r</span>(<span class="php-var">$projectInfo</span>);
} <span class="php-keyword1">catch</span> (PhpCapException <span class="php-var">$exception</span>) {
    <span class="php-keyword1">print</span> <span class="php-quote">&quot;The following error occurred: </span><span class="php-var">{$exception-&gt;getMessage()}</span><span class="php-quote">\n&quot;</span>;
    <span class="php-keyword1">print</span> <span class="php-quote">&quot;Here is a stack trace:\n&quot;</span>;
    <span class="php-keyword1">print</span> <span class="php-var">$exception</span>-&gt;getTraceAsString().<span class="php-quote">&quot;\n&quot;</span>;
}
</code></pre></div>
<p>Note that in addition to the &quot;try&quot; and &quot;catch&quot; that were added, an additional use statement was
added for the PhpCapException class: </p>
<div class="description"><pre><code class="language-php"><span class="php-keyword1">use</span> IU\PHPCap\PhpCapException;</code></pre></div></div>
<div id="footer">
PHPCap documentation
</div>
</div></div>
<script src="api/resources/combined.js"></script>
</body>
</html>
